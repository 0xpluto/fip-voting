(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[844],{6527:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/[fip]",function(){return s(4020)}])},750:function(e,t,s){"use strict";var o=s(5893);t.Z=e=>{let{children:t}=e;return(0,o.jsx)("div",{className:" bg-white  dark:bg-slate-800 rounded-md shadow-md p-3 md:p-5",children:t})}},4020:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return O}});var o=s(5893),n=s(7294),a=s(4688),r=s.n(a);let l=e=>{let t=e.split(" "),s=[];for(let e in t)t[e].length>3?s.push(r()(t[e]).capitalize().s):s.push(t[e]);return s.join(" ")};var c=e=>{let{title:t,description:s,status:n,author:a,type:r}=e;return(0,o.jsxs)("div",{className:"flex flex-col gap-2 justify-start",children:[(0,o.jsx)("div",{className:"text-sm text-neutral-400 mb-3",children:"Latest Vote Results "}),(0,o.jsx)("div",{className:"font-bold",children:t.toUpperCase()}),(0,o.jsx)("div",{children:l(s)}),(0,o.jsx)("div",{children:l(n)}),(0,o.jsx)("div",{children:l(a)}),(0,o.jsx)("div",{children:l(r)})]})},i=s(9077),d=s(1163),u=s(6154),h=s(2920),p=()=>{var e,t;let s=(0,d.useRouter)(),[a,r]=(0,n.useState)(""),{data:l,isError:c,isLoading:p,isSuccess:g,signMessage:m}=(0,i.QW)({message:"".concat(a,": FIP-").concat(parseInt(null===(e=s.query.fip)||void 0===e?void 0:e.slice(-2))),onSettled(e,t){var o,n;console.log("Settled",{data:e,error:t}),u.Z.post("".concat("http://18.116.124.40","/filecoin/vote?fip_number=").concat(parseInt(null===(o=s.query.fip)||void 0===o?void 0:o.slice(-2)),"&network=calibration"),{signature:e,message:"".concat(a,": FIP-").concat(parseInt(null===(n=s.query.fip)||void 0===n?void 0:n.slice(-2)))},{headers:{"Content-Type":"application/json"}}).then(function(e){h.Am.success("Vote casted successfully",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}).catch(function(e){console.log(e),h.Am.error(e.message,{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}});return console.log("".concat(a,": FIP-").concat(parseInt(null===(t=s.query.fip)||void 0===t?void 0:t.slice(-2)))),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"text-sm text-neutral-400 mb-3",children:"Choose Vote"}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsx)("div",{className:"NAY"===a?" border-4 border-neutral-800  dark:border-slate-200 rounded-md text-center pt-3 ":"hover:border-4 rounded-md text-center pt-3 ",style:{height:"50px",width:"100%",background:"#ED2939"},onClick:()=>r("NAY"),children:"NAY"}),(0,o.jsx)("div",{className:"ABSTAIN"===a?"border-4 border-neutral-800 dark:border-slate-200 rounded-md text-center items-center pt-3":"hover:border-4 rounded-md text-center pt-3",style:{height:"50px",width:"100%",background:"#FDDA0D"},onClick:()=>r("ABSTAIN"),children:"ABSTAIN"}),(0,o.jsx)("div",{className:"YAY"===a?"border-4 border-neutral-800  dark:border-slate-200 rounded-md text-center pt-3":"hover:border-4 rounded-md text-center pt-3",style:{height:"50px",width:"100%",background:"#228B22"},onClick:()=>r("YAY"),children:"YAY"}),(0,o.jsx)("button",{onClick:()=>m(),className:"w-100 bg-slate-400 rounded-sm py-2",children:"Vote"})]})]})},g=s(9980),m=s.n(g),x=s(8130),b=s(750),v=s(9390),f=s(3454);function j(){let[e,t]=(0,n.useState)([]),[s,a]=(0,n.useState)(!1),[r,l]=(0,n.useState)([]),{address:c,isConnected:d}=(0,i.mA)(),[p,g]=(0,n.useState)("FIP-1"),{data:m,isError:x,isLoading:b,isSuccess:v,signMessage:f}=(0,i.QW)({message:p,onSettled(e,t){console.log("Settled",{data:e,error:t}),u.Z.post("".concat("http://18.116.124.40","/filecoin/startvote?network=calibration"),{signature:e,message:p},{headers:{"Content-Type":"application/json"}}).then(function(e){console.log(e),h.Am.success("Voting Started Successfully",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}).catch(function(e){console.log(e),h.Am.error(e.message,{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}});(0,n.useEffect)(()=>{y(),r.includes(null==c?void 0:c.toLowerCase())&&a(!0),0==r.length&&j()},[c,r]);let j=async()=>{try{let e=await u.Z.get("".concat("http://18.116.124.40","/filecoin/voterstarters?network=calibration"));l(e.data)}catch(e){console.log(e)}},y=async()=>{try{let e=[],{data:s}=await u.Z.get("https://api.github.com/repos/filecoin-project/FIPS/git/trees/cad110e51558a00945e3922895cd89659b673852");s.tree.map(t=>{e.push(t.path.slice(0,3).toUpperCase()+"-"+parseInt(t.path.slice(4,8)))}),t(e)}catch(e){console.log(e)}};return s?(0,o.jsxs)("div",{className:"flex flex-row items-center  ",children:[(0,o.jsxs)("label",{className:"",children:["Choose FIP:",(0,o.jsx)("select",{className:"dark:bg-slate-600 mx-3 rounded-md p-2",value:p,onChange:e=>g(e.target.value),children:e.map(e=>(0,o.jsx)("option",{value:e,children:e},e))})]}),(0,o.jsx)("button",{onClick:()=>f(),className:"bg-green-500 shadow-md  py-2 px-4 rounded-md",children:"Start Votes"})]}):null}function y(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)([]),{address:r,isConnected:l}=(0,i.mA)(),[c,d]=(0,n.useState)("FIP-1"),[p,g]=(0,n.useState)(""),{data:m,isError:x,isLoading:b,isSuccess:v,signMessage:f}=(0,i.QW)({message:p,onSettled(e,t){console.log("Settled",{data:e,error:t}),u.Z.post("".concat("http://18.116.124.40","/filecoin/registerstarter?network=calibration"),{signature:e,message:p},{headers:{"Content-Type":"application/json"}}).then(function(e){console.log(e),h.Am.success("New Vote Starter Submitted Successfully",{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}).catch(function(e){console.log(e),h.Am.error(e.message,{position:"top-center",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}});(0,n.useEffect)(()=>{s.includes(null==r?void 0:r.toLowerCase())&&t(!0),0==s.length&&j()},[r,s]);let j=async()=>{try{let e=await u.Z.get("".concat("http://18.116.124.40","/filecoin/voterstarters?network=calibration"));console.log(e),a(e.data)}catch(e){console.log(e)}};return e?(0,o.jsxs)("div",{className:"flex flex-row items-center ",style:{padding:"8px"},children:[(0,o.jsxs)("label",{className:"",children:["Input new vote starter:",(0,o.jsx)("input",{type:"text",value:p,onChange:e=>g(e.target.value),style:{border:"2px solid gray",borderRadius:"6px"}})]}),(0,o.jsx)("button",{onClick:()=>f(),className:"bg-green-500 shadow-md  py-2 px-4 rounded-md",children:"Submit starter"})]}):null}new v.vd({auth:f.env.NODE_PUBLIC_OCTO});var w=s(5152),N=s.n(w);let k=N()(()=>s.e(909).then(s.bind(s,6909)),{loadableGenerated:{webpack:()=>[6909]}}),C=N()(()=>s.e(846).then(s.bind(s,5846)),{loadableGenerated:{webpack:()=>[5846]},ssr:!1}),S=N()(()=>Promise.all([s.e(196),s.e(853),s.e(84)]).then(s.bind(s,1084)),{loadableGenerated:{webpack:()=>[1084]},ssr:!1}),I=N()(()=>Promise.all([s.e(196),s.e(853),s.e(364)]).then(s.bind(s,364)),{loadableGenerated:{webpack:()=>[364]}});function O(){let[e,t]=(0,n.useState)(!1),[s,a]=(0,n.useState)([]),[r,l]=(0,n.useState)(!1),[i,h]=(0,n.useState)(0),[g,v]=(0,n.useState)({yay:0,nay:0,abstain:0,yay_storage_size:0,nay_storage_size:0,abstain_storage_size:0}),f=(0,d.useRouter)(),w=new(m()),[N,O]=(0,n.useState)(null);(0,n.useEffect)(()=>{_()},[f]),(0,n.useEffect)(()=>{console.log(f.query.fip),f.query.fip&&P(f.query.fip)},[f]);let P=async e=>{try{let t=await u.Z.get("https://raw.githubusercontent.com/filecoin-project/FIPs/master/FIPS/".concat(e,".md"));console.log("INFO",t.data);let s=w.parse(t.data,{})[2].children;a(s)}catch(e){console.log(e),t(!0)}},_=async()=>{l(!1);try{var e;let t=await u.Z.get("http://18.116.124.40/filecoin/vote?fip_number=".concat(parseInt(null===(e=f.query.fip)||void 0===e?void 0:e.slice(-2)),"&network=calibration"));console.log(typeof t.data),console.log("INSDIE ",t.data),console.log(Object.hasOwn(t.data,"yay")),Object.hasOwn(t.data,"yay")?v(t.data):(l(!0),h(t.data))}catch(e){console.log(e)}};return(console.log(s),e)?(0,o.jsx)(b.Z,{children:"No such FIP"}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"my-4",children:(0,o.jsx)(b.Z,{children:(0,o.jsxs)("div",{className:"flex flex-row justify-between",children:[r&&(0,o.jsx)(x.ZP,{date:Date.now()+1e3*i,onComplete:()=>_()}),(0,o.jsx)(j,{}),(0,o.jsx)(y,{})]})})}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsx)(b.Z,{children:s.length>0?(0,o.jsx)(c,{title:s[0].content,description:s[2].content,status:s[4].content,author:s[8].content,type:s[6].content}):null}),(0,o.jsx)(b.Z,{children:r?(0,o.jsx)(p,{}):(0,o.jsx)(S,{votes:g})}),(0,o.jsx)(b.Z,{children:r?(0,o.jsx)(k,{}):(0,o.jsx)(C,{data:g})})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)(b.Z,{children:(0,o.jsx)(I,{})})})]})}},5696:function(){}},function(e){e.O(0,[154,73,774,888,179],function(){return e(e.s=6527)}),_N_E=e.O()}]);